---
title: "Hypothesis Testing with scipy.stats"
author: "Isabelle Perez"
toc: true
number-sections: true
highlight-style: pygments
format: 
  html: 
    code-fold: true
    html-math-method: katex
  pdf: 
    geometry: 
      - top=30mm
      - left=20mm
##  docx: default
--- 
# Introduction 

# Basic Statistical Hypothesis Tests 
## T-test 
* Assumes observations are independent and identically distributed, normally distributed, 
and have equal variances. 
* Takes parameter alternative that can be set to "two_sided", "less", or "greater". 
* Takes optional parameter for handling null values. 
  + Can "propagate" (return nan), "raise" (raise ValueError), or "omit"(ignore null values). 
* Takes optional boolean parameter indicating equal variances. 
  + Default is True.  
  + If set to False, performs Welch's t-test, which doesn't use pooled sample variance. 

H0: mean of sample 1 = mean of sample 2 
H1: mean of sample 1 !=/>/< mean of sample 2 

## Paired t-test 
* Same assumptions as t-test with addition of observations across the two samples being 
paired. 
* Same null and alternate hypotheses as t-test and same parameters.  
* The input arrays must have the same shape. 

```{python}
import numpy as np 
import pandas as pd
from scipy import stats  

df = pd.read_csv('rodent_2022-2023.csv')  
```

## ANOVA
* Can be performed on more than two samples. 
* Same assumptions as t-test. 

H0: mean of sample 1 = mean of sample 2 = ... = mean of sample n 
H1: at least two samples have unequal means 

# Normality 
## Shapiro-Wilk Test 
* Used to test normality of a data sample.
* Assumes observations are i.i.d. 

H0: data is drawn from a normal distribution  
H1: data is not drawn from a normal distribution   
```{python}
area = df.groupby('Zip Codes')  
area_counts = area.size()  
res_1 = stats.shapiro(area_counts)
print(res_1)
```   

## NormalTest 
* Based on the D'Agostino-Pearson test for assessing normality with shape. 
  + Measures skewness and kurtosis, which is a measure of the heaviness/lightness of the
  tail relative to a normal distribution. 
  + A normal distribution has skewness of 0 and kurtosis of 3.0.  
```{python} 
res_2 = stats.normaltest(area_counts, nan_policy = 'propagate') 
print(res_2) 
```

# Correlation & Independence  
## Pearson's Correlation 
* Tests for a linear relationship between two samples.
* Assumes observations are i.i.d, normally distributed, and have equal variances.  
* Returns a correlation coefficient as well as the test statistic and p-value. 

H0: the samples are independent 
H1: there exists dependency between the samples 

## Chi-Squared Test
* Tests independece of two categorical variables using a contingency table.   
* Assumes the observations are independent and each cell of the contingency table 
has at least 25 observations.  

H0: the samples are independent
H1: there exists dependency between the samples 

# Nonparametric Hypothesis Tests   
## Mann-Whiney U Test 
* Tests that two samples are drawn from the same distribution. 
* Assumes observations are i.i.d. and can be ranked/compared. 
* Nonparametric version of t-test. 

H0: distribution of sample 1 = distribution of sample 2
H1: distribution of sample 1 !=/>/< distribution of sample 2  

## Kruskal-Wallis H Test 
* Tests that two or more samples are drawn from the same distribution. 

H0: all the samples have the same distribution 
H1: at least two samples have differing distributions 